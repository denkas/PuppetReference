<!DOCTYPE html>
<html dir="ltr" lang="en-US">
  <head>
  	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  	<title>Experimental Features: The Future Parser — Documentation — Puppet Labs</title>
  	<link rel="alternate" type="application/atom+xml" title="Puppet Labs Documentation Updates" href="https://github.com/puppetlabs/puppet-docs/commits/master.atom">
    <link rel="alternate" type="application/atom+xml" title="Puppet Labs Blog Feed" href="http://puppetlabs.com/feed/">
    <link rel='index' title='Puppet Labs Documentation' href='https://docs.puppetlabs.com' />
    <link rel='icon' href='/favicon.ico' />

     
  <meta name="description" content="  Warning: This document describes an experimental feature, which is not officially supported and is not considered ready for production. See here ...">

<!-- Google analytics -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-1537572-5']);
  _gaq.push(['_setDomainName', 'puppetlabs.com']);
  _gaq.push(['_addIgnoredRef', 'puppetlabs.com']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })();
</script>
<!-- End Google analytics -->


    <!-- FIXME: absolute paths -->

    <script type='text/javascript' src='/files/javascripts/html5.js'></script>
    <script type='text/javascript' src='/files/javascripts/jquery-1.11.1.min.js'></script>
    <script type='text/javascript' src='/files/javascripts/drop_down.js'></script>
    <script type='text/javascript' src='/files/javascripts/navigation-accordion.js'></script>

    <script type="text/javascript" src="https://puppetlabs.com/sites/all/themes/puppetlabs/js/leadcapture.js"></script>

    <!-- All in One SEO Pack 1.6.10.1 by Michael Torbert of Semper Fi Web Design[127,146] -->
    <meta name="keywords" content="Puppet, puppet labs, reductive labs, open source, system administrator, ruby, data center, automation, support" />
    <!-- /all in one seo pack -->

    <!-- Give us the option of setting a canonical URL in yaml frontmatter -NF -->
    <link rel="canonical" href="https://docs.puppetlabs.com/puppet/latest/reference/experiments_future.html" />

    <!-- FIXME: absolute paths -->

    <link rel="stylesheet" type="text/css" href="/files/stylesheets/style.css" media="screen">
    <link rel="stylesheet" type="text/css" href="/files/stylesheets/syntax.css" media="screen"> <!-- index -->

    <!--[if IE 7]>
	  <link rel="stylesheet" type="text/css" href="/files/stylesheets/ie_7.css" media="screen"> <!-- index -->
    <![endif]-->

    <!--[if IE 8]>
	    <link rel="stylesheet" type="text/css" href="/files/stylesheets/ie_8.css" media="screen"> <!-- index -->
    <![endif]-->

    <!-- Code for hover anchor links on headers begins. Relies on jQuery. Code comes from https://github.com/bryanbraun/anchorjs -->
<script type="text/javascript" src="/files/javascripts/anchor.min.js"></script>
<link rel="stylesheet" href="/files/stylesheets/anchor.css">
<script>
$(document).ready(function(){ 
    addAnchors("#content h1"); 
    addAnchors("#content h2"); 
    addAnchors("#content h3"); 
    addAnchors("#content h4"); 
    });
</script>
<!-- Code for hover anchor links ends -->

</head>




  <body id="puppetlabsdocs" class="docs">
  <!-- Google Tag Manager -->
  <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-PF6FV6"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-PF6FV6');</script>
  <!-- End Google Tag Manager -->
  <style type="text/css">h1, h2{ visibility : hidden }</style>
  <!--[if IE 8]>
    <style type="text/css">h1, h2{ visibility : visible }</style>
  <![endif]-->

  	<header id="header">
      <div class="site-width">
    		<h1><a href="https://puppetlabs.com/"><span>Puppet Labs</span></a></h1>
        <a class="screen-reader-content" href="#content">Skip navigation</a>
        <nav>
    		<ul id="global-navigation">
          <li id="puppet-tab" class="with-submenu">
            <a href="https://puppetlabs.com/puppet/puppet-enterprise">
              <span>Products</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
			<li>
                <ul>
                   <a href="https://puppetlabs.com/puppet/what-is-puppet/">What is Puppet?</a>
                </ul>
              </li>
			       <li>
                <ul>
                   <a href="https://puppetlabs.com/puppet/puppet-enterprise/">Puppet Enterprise</a>
                </ul>
              </li>
            <li>
                <ul>
                   <a href="https://puppetlabs.com/puppet/whats-new/">What's New in 2.5</a>
                </ul>
              </li>
            <li>
                <ul>
                   <a href="https://puppetlabs.com/puppet/puppet-open-source/">Puppet Open Source</a>
                </ul>
              </li>
            <li>
                <ul>
                   <a href="https://puppetlabs.com/puppet/enterprise-vs-open-source/">Enterprise vs. Open Source</a>
                </ul>
              </li>
              <li>
                <ul>
                  <a href="https://forge.puppetlabs.com">Puppet Forge</a>
                </ul>
              </li>
              <li>
                <ul>
                  <a href="https://puppetlabs.com/puppet/requirements/">Components &amp; Requirements</a>
                </ul>
              </li>
              <li>
                <ul>
                  <a href="https://puppetlabs.com/puppet/faq/">FAQ</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="https://puppetlabs.com/puppet/how-to-buy/">How to Buy</a>
                </ul>
              </li>
            </ul>
          </li>
          <li id="solutions-tab" class="with-submenu">
            <a href="https://puppetlabs.com/solutions/">
              <span>Solutions</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-12296"><a href="https://puppetlabs.com/solutions/configuration-management/">Configuration Management</a></li>
<li class="page_item page-item-986"><a href="https://puppetlabs.com/solutions/virtualization-management/">Virtualization Management</a></li>
<li class="page_item page-item-993"><a href="https://puppetlabs.com/solutions/cloud-management/">Cloud Management</a></li>
<li class="page_item page-item-996"><a href="https://puppetlabs.com/solutions/it-compliance/">IT Compliance</a></li>
<li class="page_item page-item-9520"><a href="https://puppetlabs.com/solutions/devops/">DevOps</a></li>
<li class="page_item page-item-991"><a href="https://puppetlabs.com/solutions/manage-os-x-resources/">OS X Desktops</a></li>
            </ul>
          </li>
          <li id="services-tab" class="with-submenu">
            <a href="https://puppetlabs.com/services/">
              <span>Services</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-783"><a href="https://puppetlabs.com/services/overview/">Overview</a></li>
<li class="page_item page-item-1052"><a href="https://puppetlabs.com/services/customer-support/">Customer Support</a></li>
<li class="page_item page-item-11022"><a href="https://puppetlabs.com/services/support-plans/">Support Plans</a></li>
<li class="page_item page-item-845"><a href="https://puppetlabs.com/services/training-workshops/">On-Site Education</a></li>
<li class="page_item page-item-4899"><a href="https://puppetlabs.com/services/consulting/">Professional Services</a></li>
<li class="page_item page-item-849"><a href="https://puppetlabs.com/category/events/upcoming/">Events &amp; Workshops</a></li>
<li class="page_item page-item-851"><a href="https://puppetlabs.com/services/partners/">Partners</a></li>
            </ul>
          </li>
                    <li id="resources-tab" class="with-submenu">
            <a href="https://puppetlabs.com/resources/">
              <span>Resources</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-1048"><a href="https://puppetlabs.com/resources/overview-2/">Overview</a></li>
<li class="page_item page-item-1040"><a href="https://docs.puppetlabs.com">Documentation</a></li>
<li class="page_item page-item-872"><a href="http://info.puppetlabs.com/register-download">Downloads</a></li>
<li class="page_item page-item-1961"><a href="https://forge.puppetlabs.com">Puppet Forge</a></li>
<li class="page_item page-item-835"><a href="http://info.puppetlabs.com/download-whitepapers.html">White Papers</a></li>
<li class="page_item page-item-7279"><a href="https://puppetlabs.com/resources/webinars/">Upcoming Webinars</a></li>
<li class="page_item page-item-10183"><a href="https://puppetlabs.com/resources/newsletter/">Newsletter</a></li>
<li class="page_item page-item-12263"><a href="https://puppetlabs.com/resources/tech-notes/">Tech Notes</a></li>
<li class="page_item page-item-10265"><a href="http://info.puppetlabs.com/pe2-webinar.html">Webinars</a></li>
            </ul>
          </li>

          <li id="customers-tab" class="with-submenu">
            <a href="https://puppetlabs.com/customers/companies/">
              <span>Customers</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
			<li>
                <ul>
                  <a href="https://puppetlabs.com/customers/companies/">Companies</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="https://puppetlabs.com/customers/case-studies/">Case Studies</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="https://puppetlabs.com/customers/product-testimonials/">Product Testimonials</a>
                </ul>
              </li>
			    <li>
                <ul>
                  <a href="https://puppetlabs.com/customers/what-customers-are-saying/">Service Testimonials</a>
                </ul>
              </li>
            </ul>
          </li>
          <li id="community-tab" class="with-submenu">
            <a href="https://puppetlabs.com/community/">
              <span>Community</span>
              <span class="drop-down-trigger"></span>
            </a>

 <ul>
			<li>
                <ul>
                  <a href="https://puppetlabs.com/community/overview/">Overview</a>
                </ul>
              </li>
			<li>
                <ul>
                  <a href="https://puppetlabs.com/blog">Blog</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="https://puppetlabs.com/community/puppet-camp/">Puppet Camp</a>
                </ul>
              </li>
			  <li>
                <ul>
                  <a href="https://puppetlabs.com/community/user-groups-and-devops-groups/">Puppet User Groups & DevOps Groups</a>
                </ul>
              </li>
	          <li>
                <ul>
                  <a href="https://puppetlabs.com/community/presentations/">Presentations</a>
                </ul>
              </li>
			    <li>
                <ul>
                  <a href="https://puppetlabs.com/community/videos/">Videos</a>
                </ul>
              </li>
            </ul>

          <li id="company-tab" class="with-submenu">
            <a href="https://puppetlabs.com/company/">
              <span>Company</span>
              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-2316"><a href="https://puppetlabs.com/company/overview/">Overview</a></li>
<li class="page_item page-item-2179"><a href="https://puppetlabs.com/company/news/">News</a>
<ul class='children'>
	<li class="page_item page-item-2338"><a href="https://puppetlabs.com/company/news/press-releases/">Press Releases</a></li>
	<li class="page_item page-item-2383"><a href="https://puppetlabs.com/company/news/media-kit/">Media Kit</a></li>
</ul>
</li>
<li class="page_item page-item-1571"><a href="https://puppetlabs.com/company/careers/">Careers</a></li>
<li class="page_item page-item-10372"><a href="https://puppetlabs.com/company/management/">Management</a></li>
<li class="page_item page-item-10311"><a href="https://puppetlabs.com/company/board-and-advisors/">Board and Advisors</a></li>
<li class="page_item page-item-10367"><a href="https://puppetlabs.com/company/investors/">Investors</a></li>
<li class="page_item page-item-2313"><a href="https://puppetlabs.com/company/contact-us/">Contact Us</a></li>
<li class="page_item page-item-10579"><a href="https://puppetlabs.com/company/awards/">Awards</a></li>
            </ul>
          </li>
    		</ul>
          <div id="misc-navigation">
			  <ul>
				<li><a href="https://puppetlabs.com/security/">Security</a></li>
				<li><a href="https://docs.puppetlabs.com">Documentation</a></li>
				<li><a href="https://puppetlabs.com/resources/customer-support/">Support</a></li>
			        <li><a href="https://tickets.puppetlabs.com/">Bug Tracker</a></li>
				<li><a href="https://puppetlabs.com/company/contact/contact-us">Contact Us</a></li>
				<li><a href="http://info.puppetlabs.com/download-pe2.html" class="gateway">Download</a></li>
			  </ul>
			<form action="https://www.google.com/cse" id="cse-search-box">
			  <div>
				<input type="hidden" name="cx" value="017668764424496204839:ubligvgbenm" />
				<input type="hidden" name="ie" value="UTF-8" />
				<input type="text" name="q" class="gsc-input" size="31" />
				<input type="submit" name="sa" class="searchbtn" value="Search" />
			  </div>
			</form>
			<script type="text/javascript" src="https://www.google.com/cse/brand?form=cse-search-box&lang=en"></script>
          </div>
      </nav>
    	</div>
    </header>

      <section id="masthead">
        <div class="site-width">
          <h1>Docs: <span class="section-name">Experimental Features: The Future Parser</span></h1>
        </div>
        <br />
      </section>

      <section id="content">
        <div class="site-width">
          <div class="primary-secondary-content">
            <div class="primary-content">
              <h1>Experimental Features: The Future Parser</h1>
              <nav class="in-page" id="page-nav">
<ol class="toc">
  <li class="toc-lv2"><a href="#enabling-the-future-parser">Enabling the Future Parser</a></li>
  <li class="toc-lv2"><a href="#lambdas-and-iteration">Lambdas and Iteration</a></li>
  <li class="toc-lv2"><a href="#other-new-language-features">Other New Language Features</a>
<ol class="toc">
   <li class="toc-lv3"><a href="#expressions-are-now-valid-statements">Expressions Are Now Valid Statements</a></li>
   <li class="toc-lv3"><a href="#arrayhash-literals-are-now-allowed-anywhere-arrayshashes-are-allowed">Array/Hash Literals are Now Allowed Anywhere Arrays/Hashes are Allowed</a></li>
   <li class="toc-lv3"><a href="#concatenation-and-append">Concatenation and Append</a></li>
   <li class="toc-lv3"><a href="#a-semicolon-acts-as-an-optional-expression-separator">A Semicolon Acts as an Optional Expression Separator</a></li>
   <li class="toc-lv3"><a href="#functions-that-produce-a-value-may-be-invoked-as-statements">Functions That Produce a Value May Be Invoked as Statements</a></li>
   <li class="toc-lv3"><a href="#right-side-of-matches-may-be-a-string-unfinished">Right Side of Matches May Be a String (unfinished)</a></li>
   <li class="toc-lv3"><a href="#unless-with-else-supported">Unless with Else Supported</a></li>
   <li class="toc-lv3"><a href="#chained-assignments">Chained Assignments</a></li>
   <li class="toc-lv3"><a href="#function-calls-in-interpolation-supported">Function Calls in Interpolation Supported</a></li>
</ol></li>
  <li class="toc-lv2"><a href="#new-language-restrictions">New Language Restrictions</a>
<ol class="toc">
   <li class="toc-lv3"><a href="#user-defined-numeric-variables-not-allowed">User Defined Numeric Variables Not Allowed</a></li>
   <li class="toc-lv3"><a href="#capitalized-variable-names-not-allowed">Capitalized Variable Names Not Allowed</a></li>
   <li class="toc-lv3"><a href="#bare-words-may-not-start-with-a-digit">“Bare Words” May Not Start with a Digit</a></li>
   <li class="toc-lv3"><a href="#numbers-are-validated-if-entered-without-quotes">Numbers Are Validated If Entered without Quotes</a></li>
</ol></li>
  <li class="toc-lv2"><a href="#error-reporting-improvements">Error Reporting Improvements</a>
<ol class="toc">
   <li class="toc-lv3"><a href="#many-errors-now-contain-position-on-line">Many Errors Now Contain Position on Line</a></li>
   <li class="toc-lv3"><a href="#odd-expected-errors-fixed">Odd “Expected” Errors Fixed</a></li>
   <li class="toc-lv3"><a href="#error-and-warning-feedback">Error and Warning Feedback</a></li>
   <li class="toc-lv3"><a href="#fat-arrow--as-comma-is-not-supported">Fat Arrow (=&gt;) as Comma Is Not Supported</a></li>
</ol></li>
</ol></nav>
              
<blockquote>
  <p><strong>Warning:</strong> This document describes an <strong>experimental feature,</strong> which is not officially supported and is not considered ready for production. <a href="./experiments_overview.html">See here for more information about experimental features in Puppet</a>, especially if you are using Puppet Enterprise.</p>
</blockquote>

<blockquote>
  <p><strong>Status:</strong> In Puppet 3.7, the future parser performs much better than it used to. We think it’s about on par with the default parser, but haven’t extensively speed tested it with real-world manifests. It should still be considered a preview, but can now be used with larger test environments.</p>

  <p>The new language features in the future parser are still being designed and considered. If you want to join the conversation, or if some of your manifests don’t work the way you think they should under the future parser, please join <a href="https://groups.google.com/forum/#!forum/puppet-users">the puppet-users group</a> and tell us what you’ve learned.</p>
</blockquote>

<p>You can set <code>parser = future</code> in puppet.conf to enable experimental new language features, which may or may not be included in a future Puppet version.</p>

<p>Under the hood, the “future” parser is a ground-up reimplementation of the Puppet grammar and evaluator. In addition to the experimental features it includes, the “future” parser makes some other changes and clean-ups to the language.</p>

<h2 id="enabling-the-future-parser">Enabling the Future Parser</h2>

<p>To enable the future parser:</p>

<ul>
  <li>On your puppet master(s) (or all nodes, if running puppet apply), ensure the <code>rgen</code> gem is installed. If you installed Puppet from the official packages, this was already installed as a dependency; otherwise, you may need to install it manually.</li>
  <li>On your puppet master(s) (or each node, if running puppet apply), set <a href="/references/latest/configuration.html#parser"><code>parser = future</code></a> in the <code>[master]</code> or <code>[main]</code> section of puppet.conf. (In a masterless “puppet apply” deployment, use <code>[main]</code>.)
    <ul>
      <li>Alternately, for one-off tests, you can set <code>--parser future</code> on the command line when running puppet apply.</li>
    </ul>
  </li>
</ul>

<h2 id="lambdas-and-iteration">Lambdas and Iteration</h2>

<p>The most complex features added by the future parser involve iterations and transformations acting on collections of data.</p>

<p>These features are covered in a separate document:</p>

<ul>
  <li><a href="./experiments_lambdas.html">Experimental Features: Lambdas and Iteration</a></li>
</ul>

<h2 id="other-new-language-features">Other New Language Features</h2>

<p>The future parser makes several other additions to the Puppet language.</p>

<h3 id="expressions-are-now-valid-statements">Expressions Are Now Valid Statements</h3>

<p>In Puppet 3 it is not possible to have a body of code that is just an expression. This makes it</p>

<p>difficult to enter predicates as in the case of a collect or reject.</p>

<p>An expression such as…</p>

<pre><code>1 + 2
</code></pre>

<p>…is now a legal statement if it appears as the last “statement” in a block. Block “return” their last expression/statement as its produced result. There is no explicit “return”, it is always the value of the last evaluated expression.</p>

<h3 id="arrayhash-literals-are-now-allowed-anywhere-arrayshashes-are-allowed">Array/Hash Literals are Now Allowed Anywhere Arrays/Hashes are Allowed</h3>

<p>In Puppet 3, if you wanted to operate on a literal array or hash, you typically had to assign it to a variable first. This was due to how the internal grammar for the language was organized. You can now use literal arrays and hashes more naturally in a puppet manifest.</p>

<pre><code>notice([1, 2][1])
# produces the output
Notice: Scope(Class[main]): 2
</code></pre>

<h3 id="concatenation-and-append">Concatenation and Append</h3>

<p>You can concatenate array and merge hashes with <code>+</code></p>

<pre><code>[1,2,3] + [4,5,6]   # produces [1,2,3,4,5,6]
{a =&gt; 1} + {b =&gt; 2} # produces {a=&gt;1, b=&gt;2 }
</code></pre>

<p>You can append to an array with <code>&lt;&lt;</code></p>

<pre><code>[1,2,3] &lt;&lt; 10 # produces [1,2,3,10]
[1,2,3] &lt;&lt; [4,5] # produces [1,2,3,[4,5]]
</code></pre>

<h3 id="a-semicolon-acts-as-an-optional-expression-separator">A Semicolon Acts as an Optional Expression Separator</h3>

<p>There is one corner case in the expression based grammar that required an expression separator <code>;</code> to be added. It can optionally be used to increase readability in one-liners.</p>

<pre><code>$a = 1; $b = 10
</code></pre>

<p>Which naturally also is legal without the semicolon.</p>

<p>The separator becomes important when you want to end a block with a literal array or hash, and when they would alter the meaning of the <em>preceding</em> operand. (This example makes use of <code>+</code> to concatenate two arrays)</p>

<pre><code>{ $x = [[1],[2],[3]]
  $a = [a] + $x[1]
}
# Results in $a being assigned [a,2], and this is also the value
# returned by the block
</code></pre>

<p>is very different from:</p>

<pre><code>{ $x = [[1],[2],[3]]
  $a = [a] + $x; [1]
}
# Results in $a being assigned to [a, [1],[2],[3]] and the
# result of the block (which is returned) is [1]
</code></pre>

<h3 id="functions-that-produce-a-value-may-be-invoked-as-statements">Functions That Produce a Value May Be Invoked as Statements</h3>

<p>It is harmless to call a function that produce a value and not use the returned value. Puppet 3 forbids this and raises an error. With the entry of iteration functions (which always return a value, but may be used for only the side effects) this was made impossible by Puppet 3’s separation of function (returning a value) and procedure (returning nothing).</p>

<h3 id="right-side-of-matches-may-be-a-string-unfinished">Right Side of Matches May Be a String (unfinished)</h3>

<p>It is allowed to have a string instead of a regular expression in matches expressions. The intent is to support variable interpolation in these strings before they are converted to regular expressions. This is unfinished, and will currently result in an error when evaluated (instead of when parsed).</p>

<h3 id="unless-with-else-supported">Unless with Else Supported</h3>

<p>An <code>unless</code> can now have an <code>else</code> clause (but it cannot be combined with an <code>elsif</code>).</p>

<p>While not being recommended to use complex logic in <code>unless</code>, it is at the same time quite annoying to have to reverse tests in order to be able to do something like a notice “unless not triggered” for debugging.</p>

<h3 id="chained-assignments">Chained Assignments</h3>

<p>Chained assignments are now possible for both <code>=</code>, and <code>+=</code>.</p>

<pre><code>$a = $b = 10
</code></pre>

<p>Note that <code>=</code> and <code>+=</code> have low precedence, so this is an error:</p>

<pre><code>$a = 1 + $b = 10 # i.e. this is parsed as $a = (1 + $b) = 10
</code></pre>

<p>and needs to be written</p>

<pre><code>$a = 1 + ($b = 10)
</code></pre>

<p>Assignments may thus also be used where expressions are.</p>

<h3 id="function-calls-in-interpolation-supported">Function Calls in Interpolation Supported</h3>

<p>Calling a function in interpolation now works:</p>

<pre><code>notice "This is a random number: ${fqdn_rand(30)}
</code></pre>

<p>This has mysterious result in the regular parser since it is interpreted as</p>

<pre><code>${$fqdn_rand(30)}
</code></pre>

<h2 id="new-language-restrictions">New Language Restrictions</h2>

<p>Since the future parser will not be enabled until at least the next major version boundary, we took the opportunity to clean up certain edge cases and oddities in the language. Most code written for the current parser should be forward compatible, but watch for these changes:</p>

<h3 id="user-defined-numeric-variables-not-allowed">User Defined Numeric Variables Not Allowed</h3>

<p>Assignments to numeric variables are flagged as errors.</p>

<p>This is illegal:</p>

<pre><code>$3 = 'hello'
</code></pre>

<p>In some puppet versions this produces strange effects, and in some it is silently ignored.</p>

<p>As a consequence it is also illegal to name parameters in defines, and parameterized classes with numeric names.</p>

<p>This is illegal:</p>

<pre><code>define mytype ($1, $2) { … }
</code></pre>

<p>It is ok to use names with digits 0-9 as long as one character is not a digit.</p>

<h3 id="capitalized-variable-names-not-allowed">Capitalized Variable Names Not Allowed</h3>

<p>Variable names may not contain capital letters. They are limited to lowercase letters, numbers, and underscores.</p>

<h3 id="bare-words-may-not-start-with-a-digit">“Bare Words” May Not Start with a Digit</h3>

<p>The positive effect of this is that numbers entered without quotes can be validated to be correct decimal, hex or octal values.</p>

<h3 id="numbers-are-validated-if-entered-without-quotes">Numbers Are Validated If Entered without Quotes</h3>

<p>If you enter an unquoted number in decimal, hex or octal it is now validated, and an error is raised if it is illegal.</p>

<p>These will raise errors:</p>

<pre><code>$a = 0x0EH
$b = 0778
</code></pre>

<h2 id="error-reporting-improvements">Error Reporting Improvements</h2>

<p>Another feature of the future parser is that it’s now possible to introspect extra information about errors. We use this to improve error messages when using it.</p>

<h3 id="many-errors-now-contain-position-on-line">Many Errors Now Contain Position on Line</h3>

<p>If available, errors now output position on the line. This helps for errors related to punctuation such as <code>{</code> since it may appear several times on a line and the problem may be hard to find/understand. (This problem was made worse with the addition of lambdas to the language since they are typically entered as one-liners).</p>

<p>The output format is: <code>filename:line:pos</code></p>

<p>Pos is never displayed without a line; if you see <code>file:3</code>, it is a reference to the line.</p>

<p>Position starts from 1 (first character on a line is in position 1).</p>

<h3 id="odd-expected-errors-fixed">Odd “Expected” Errors Fixed</h3>

<p>When there is a syntax error involving a token that is paired (e.g. <code>{</code>, <code>(</code>, <code>[</code>), the error message always said “<code>expected ...</code>” and it showed the matching side of the violating token. This is only correct if the problem is reaching EOF. In all other cases this information was misleading, and adding what was suggested would almost always make things worse.</p>

<p>The “expected” is now only included when encountering the end of file and there are outstanding expectations (such as terminating an open string).</p>

<h3 id="error-and-warning-feedback">Error and Warning Feedback</h3>

<p>Error and Warning feedback from parsing now outputs multiple errors / warnings (if multiple were found before lower level parsing gave up). The default cap on output of these are 10. The number can be changed via the following puppet.conf settings:</p>

<ul>
  <li><code>max_errors</code></li>
  <li><code>max_warnings</code></li>
  <li><code>max_deprecations</code></li>
</ul>

<p>When there are multiple errors, the output emits errors up to the cap. A final error is then generated with the error and warning count. If there is only one error, only this error is emitted (no count). Deprecations count as warnings.</p>

<p>As an example, you can try this:</p>

<pre><code>$ puppet apply --parser future -e '$a = node "a+b" { }'
Error: Invalid use of expression. A Node Definition does not produce a value at line 1:6
Error: The hostname 'a+b' contains illegal characters (only letters, digits, '_', '-', and '.' are allowed) at line 1:11
Error: Classes, definitions, and nodes may only appear at toplevel or inside other classes at line 1:6
Error: Could not parse for environment production: Found 3 errors. Giving up on node henriks-macbook-pro.local
</code></pre>

<h3 id="fat-arrow--as-comma-is-not-supported">Fat Arrow (<code>=&gt;</code>) as Comma Is Not Supported</h3>

<p>In the Puppet 3 parser, it is allowed to use a fat arrow <code>=&gt;</code> in many places where a comma is required. This undocumented feature is removed in the experimental parser.</p>

              <blockquote><p style="font-size: 1.3em; text-align: center;"><a href="#content">↑ Back to top</a></p></blockquote>
            </div>
            <nav class="main">
                  <div id="subCol">
                      <ul id="doc-navigation">
                        <li class="with-submenu">
                          <a href="#">
                            <span>Docs Quick Nav</span>
                            <span class="drop-down-trigger"></span>
                          </a>
                                           <dl>
                  <dt>Home</dt>
                    <dd><a href="/">Puppet Docs Front Page</a></dd>
                  <dt>#1 Most Popular</dt>
                    <dd><a href="/references/stable/type.html">The Resource Type Reference</a></dd>
                  <dt>Puppet Enterprise</dt>
                    <dd><a href="/pe/latest/">Puppet Enterprise User's Guide (latest)</a></dd>
                    <dd><a href="/pe/latest/quick_start.html">Quick Start Guide</a></dd>
                  <dt>Puppet in General (PE &amp; Open Source)</dt>
                      <dd><a href="/puppet/latest/reference">Puppet Reference Manual (latest)</a></dd>
                      <dd><a href="/learning/">Learning Puppet</a></dd>
                      <dd><a href="/references/glossary.html">Glossary of Puppet Terms</a></dd>
                  <dt>Open Source Puppet</dt>
                    <dd><a href="/guides/install_puppet/pre_install.html">Installing</a></dd>
                    <dd><a href="/guides/install_puppet/upgrading.html">Upgrading</a></dd>
                  <dt>Facter</dt>
                      <dd><a href="/facter/latest/core_facts.html">Core Facts Reference</a></dd>
                      <dd><a href="/facter/latest/fact_overview.html">Writing Custom Facts</a></dd>
                  <dt>PuppetDB</dt>
                      <dd><a href="/puppetdb/latest">PuppetDB Manual</a></dd>
                  <dt>MCollective</dt>
                      <dd><a href="/mcollective/index.html">All MCollective Docs</a></dd>
                      <dd><a href="/mcollective/reference/index.html">References</a></dd>
                      <dd><a href="/mcollective/simplerpc/index.html">Writing Plugins</a></dd>
                </dl>

                        </li>
                      </ul>

                      <h3 id="puppet-3-7-reference-manual">Puppet 3.7 Reference Manual</h3>

<ul>
  <li><a href="./index.html">Introduction</a></li>
  <li><a href="./release_notes.html">Puppet 3.7 Release Notes</a></li>
  <li><strong>Deprecated Features</strong>
    <ul>
      <li><a href="./deprecated_summary.html">About Deprecations in This Version</a></li>
      <li><a href="./deprecated_language.html">Language Features</a></li>
      <li><a href="./deprecated_resource.html">Resource Type Features</a></li>
      <li><a href="./deprecated_api.html">Extension Points and APIs</a></li>
      <li><a href="./deprecated_command.html">Command Line Features</a></li>
      <li><a href="./deprecated_settings.html">Settings</a></li>
      <li><a href="./deprecated_windows_api.html">Breaking Changes to Private Windows APIs</a></li>
      <li><a href="./deprecated_misc.html">Other Features</a></li>
    </ul>
  </li>

  <li><a href="./system_requirements.html">System Requirements</a></li>
  <li><a href="./architecture.html">Overview of Puppet's Architecture</a></li>

  <li><strong>Puppet's Services and Tools</strong>
    <ul>
      <li><a href="./services_commands.html">Puppet's Commands</a></li>
      <li><a href="./services_commands_windows.html">Running Puppet Commands on Windows</a></li>
      <li><a href="./services_master_webrick.html">The WEBrick Puppet Master</a></li>
      <li><a href="./services_master_rack.html">The Rack Puppet Master</a></li>
      <li><a href="./services_agent_unix.html">Puppet Agent on *nix</a></li>
      <li><a href="./services_agent_windows.html">Puppet Agent on Windows</a></li>
      <li><a href="./services_apply.html">Puppet Apply</a></li>
    </ul>
  </li>

  <li><strong>The Puppet Language</strong>
    <ul>
      <li><a href="./lang_visual_index.html">Visual Index</a></li>
      <li><a href="./lang_summary.html">Basics</a></li>
      <li><a href="./lang_reserved.html">Reserved Words and Allowed Names</a></li>
      <li><a href="./lang_resources.html">Resources</a></li>
      <li><a href="./lang_windows_file_paths.html">Handling File Paths on Windows</a></li>
      <li><a href="./lang_relationships.html">Relationships and Ordering</a></li>
      <li><a href="./lang_defaults.html">Resource Defaults</a></li>
      <li><a href="./lang_variables.html">Variables</a></li>
      <li><a href="./lang_facts_and_builtin_vars.html">Facts and Built-in Variables</a></li>
      <li><a href="./lang_scope.html">Scope</a></li>
      <li><a href="./lang_conditional.html">Conditional Statements</a></li>
      <li><a href="./lang_expressions.html">Expressions</a></li>
      <li><a href="./lang_functions.html">Functions</a></li>
      <li><a href="./lang_classes.html">Classes</a></li>
      <li><a href="./lang_defined_types.html">Defined Types</a></li>
      <li><a href="./lang_containment.html">Containment</a></li>
      <li><a href="./lang_namespaces.html">Namespaces and Autoloading</a></li>
      <li><a href="./lang_collectors.html">Resource Collectors</a></li>
      <li><a href="./lang_node_definitions.html">Node Definitions</a></li>
      <li><a href="./lang_datatypes.html">Data Types</a></li>
      <li><a href="./lang_comments.html">Comments</a></li>
      <li><a href="./lang_virtual.html">Virtual Resources</a></li>
      <li><a href="./lang_exported.html">Exported Resources</a></li>
      <li><a href="./lang_tags.html">Tags</a></li>
      <li><a href="./lang_run_stages.html">Run Stages</a></li>
      <li><a href="./lang_import.html">Importing Manifest Files</a></li>
    </ul>
  </li>

  <li><strong>Modules</strong>
    <ul>
      <li><a href="./modules_fundamentals.html">Fundamentals</a></li>
      <li><a href="/guides/plugins_in_modules.html">Plugins in Modules</a></li>
      <li><a href="./modules_installing.html">Installing Modules</a></li>
      <li><a href="./modules_publishing.html">Publishing Modules on the Puppet Forge</a></li>
      <li><a href="./modules_documentation.html">Module Documentation</a></li>
    </ul>
  </li>

  <li><a href="/references/3.7.latest/type.html">The Resource Type Reference</a></li>

  <li><strong>Resource Types: Tips and Examples</strong>
    <ul>
      <li><a href="./resources_service.html">Service Resources (All OSes)</a></li>
      <li><a href="./resources_file_windows.html">File Resources (Windows)</a></li>
      <li><a href="./resources_package_windows.html">Package Resources (Windows)</a></li>
      <li><a href="./resources_user_group_windows.html">User and Group Resources (Windows)</a></li>
      <li><a href="./resources_scheduled_task_windows.html">Scheduled Task Resources (Windows)</a></li>
      <li><a href="./resources_exec_windows.html">Exec Resources (Windows)</a></li>
      <li><a href="./resources_windows_optional.html">Optional Resource Types for Windows</a></li>
    </ul>
  </li>

  <li><strong>Misc. References (Settings, Functions, HTTP, etc.)</strong>
    <ul>
      <li><a href="/references/3.7.latest/configuration.html">Settings (Configuration Reference)</a></li>
      <li><a href="/references/3.7.latest/function.html">Functions</a></li>
      <li><a href="/references/3.7.latest/metaparameter.html">Metaparameters</a></li>
      <li><a href="/references/3.7.latest/report.html">Report Handlers</a></li>
      <li><a href="/references/3.7.latest/indirection.html">Indirections and Termini</a></li>
      <li><a href="/references/3.7.latest/developer/index.html">Ruby API for Developing Extensions</a></li>
      <li><a href="/references/3.7.latest/developer/file.http_api_index.html">Puppet's HTTP API</a></li>
    </ul>
  </li>
  <li><strong>Important Directories and Files</strong>
    <ul>
      <li><a href="./dirs_confdir.html">The Main Config Directory (Confdir)</a></li>
      <li><a href="./dirs_manifest.html">The Main Manifest(s)</a></li>
      <li><a href="./dirs_modulepath.html">The Modulepath</a></li>
      <li><a href="./dirs_ssldir.html">The SSLdir</a></li>
      <li><a href="./dirs_vardir.html">The Vardir</a></li>
    </ul>
  </li>
  <li><strong>Environments</strong>
    <ul>
      <li><a href="./environments.html">About Environments</a></li>
      <li><a href="./environments_configuring.html">Configuring Directory Environments</a></li>
      <li><a href="./environments_creating.html">Creating Directory Environments</a></li>
      <li><a href="./environments_assigning.html">Assigning Environments to Nodes</a></li>
      <li><a href="./environments_classic.html">Using Config File Environments (deprecated)</a></li>
      <li><a href="./environments_suggestions.html">Suggestions for Use</a></li>
      <li><a href="./environments_limitations.html">Limitations of Environments</a></li>
      <li><a href="./environments_https.html">Environments and Puppet's HTTPS Interface</a></li>
    </ul>
  </li>
  <li><strong>Configuration</strong>
    <ul>
      <li><a href="./config_about_settings.html">About Puppet's Settings</a></li>
      <li><a href="./config_print.html">Checking Values of Settings</a></li>
      <li><a href="./config_set.html">Editing Settings on the Command Line</a></li>
      <li><a href="./config_important_settings.html">Short List of Important Settings</a></li>
      <li><a href="/references/3.7.latest/configuration.html">Complete List of Settings (Configuration Reference)</a></li>
      <li><strong>Config Files</strong>
        <ul>
          <li><a href="./config_file_main.html">puppet.conf: The Main Config File</a></li>
          <li><a href="./config_file_auth.html">The auth.conf File</a></li>
          <li><a href="./config_file_autosign.html">The autosign.conf File</a></li>
          <li><a href="./config_file_csr_attributes.html">The csr_attributes.yaml File</a></li>
          <li><a href="./config_file_device.html">The device.conf File</a></li>
          <li><a href="./config_file_environment.html">The environment.conf Files</a></li>
          <li><a href="./config_file_fileserver.html">The fileserver.conf File</a></li>
          <li><a href="./config_file_hiera.html">The hiera.yaml File</a></li>
          <li><a href="./config_file_puppetdb.html">The puppetdb.conf File</a></li>
          <li><a href="./config_file_routes.html">The routes.yaml File</a></li>
          <li><a href="./config_file_tagmail.html">The tagmail.conf File</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><strong>SSL and Certificates</strong>
    <ul>
      <li><a href="./config_ssl_external_ca.html">Using an External CA</a></li>
      <li><a href="./ssl_autosign.html">Configuring Autosigning</a></li>
      <li><a href="./ssl_attributes_extensions.html">CSR Attributes and Certificate Extensions</a></li>
      <li><a href="./ssl_regenerate_certificates.html">Regenerating All Certificates in a Deployment</a></li>
    </ul>
  </li>

  <li><strong>Data Formats</strong>
    <ul>
      <li><a href="./format_report.html">Report Format</a></li>
    </ul>
  </li>

  <li><strong>Puppet Subsystems</strong>
    <ul>
      <li><a href="./subsystem_agent_master_comm.html">Agent/Master HTTPS Communications</a></li>
      <li><a href="./subsystem_catalog_compilation.html">Catalog Compilation</a></li>
    </ul>
  </li>
  <li><strong>Experimental Features</strong>
    <ul>
      <li><a href="./experiments_overview.html">Overview</a></li>
      <li><a href="./experiments_future.html">The Future Parser and Evaluator</a></li>
      <li><a href="./experiments_lambdas.html">Iteration and Lambdas</a></li>
      <li><a href="./experiments_msgpack.html">Msgpack Support</a></li>
      <li><a href="./experiments_cfacter.html">Native Facter</a></li>
    </ul>
  </li>
</ul>


                                                              <!-- Current promo images -->
            <hr style="margin-top: 20px; margin-bottom: 20px;">
            <div style="margin-top: 10px; padding-bottom: 10px;">
                <p style="font-family: 'Lucida Grande',Lucida,Verdana,sans-serif;font-size: 16px; font-weight: bold; line-height: 22px; margin-bottom: 10px;">Learning Puppet VM</p>

                <p style="font-size:0.9em;line-height: 1.5em;"><a href="http://info.puppetlabs.com/download-learning-puppet-VM.html">Learn Puppet</a> in a safe, convenient virtual environment - free download</p>
                <a href="http://info.puppetlabs.com/download-learning-puppet-VM.html">
                <img src="/images/learning-puppet-vm.jpg" class="Learning Puppet VM" alt="Learning Puppet VM screenshot">
                </a>
            </div>
            <div style="margin-top: 10px; padding-bottom: 10px;">
                <p style="font-family: 'Lucida Grande',Lucida,Verdana,sans-serif;font-size: 16px; font-weight: bold; line-height: 22px; margin-bottom: 10px;">Free Online Learning</p>
                <a href="https://puppetlabs.com/learn"><img src="/images/LMS_Forge_Ad.png" alt="Puppet Labs Workshop promo"></a>
            </div>
            <div style="margin-top: 10px; padding-bottom: 10px;">
                <p style="font-family: 'Lucida Grande',Lucida,Verdana,sans-serif;font-size: 16px; font-weight: bold; line-height: 22px; margin-bottom: 10px;">Download the Docs</p>
                <a href="http://info.puppetlabs.com/download-pdfs.html"><img src="/images/smallbits_small_docs.png" alt="Puppet docs download"></a>
            </div>

                  </div>
            </nav>
          </div>
        </div>
      </section>

		<footer id="footer">
      <div class="site-width">

        <div class="primary-secondary-content">
          <div class="primary-content">
            <section id="newsletter">
                 <h4>Puppet Labs is Hiring</h4>
                 <p><a href="https://puppetlabs.com/company/jobs/">Engineers, developers & consultants</a>
                  <p>
		<h4>Newsletter</h4>

              <p>Stay up to date on all things puppet</p>

				<form class="lpeRegForm formNotEmpty" method="post" enctype="application/x-www-form-urlencoded" action="https://app-h.marketo.com/index.php/leadCapture/save"; id="mktForm_1013" name="mktForm_1013">

				<label>Email Address:</label><span class='mktInput'><input class='mktFormText mktFormEmail' name="Email" id="Email" type='email' value="" maxlength='255'  /><span class='mktFormMsg'></span></span>

				<input id='mktFrmSubmit' type='submit' class='btn' style="width: auto; overflow: visible; padding-left: .25em; padding-right: .25em;" value='Subscribe' name='submitButton' onclick='formSubmit(document.getElementById("mktForm_1013")); return false;' />

				<input style='display: none;' id='mktFrmReset' type='reset' value='Clear' name='resetButton' onclick='formReset(document.getElementById("mktForm_1013")); return false;' />

				<span style="display:none;"><input type="text" name="_marketo_comments" value="" /></span>
				<input type="hidden" name="lpId" value="-1" />
				<input type="hidden" name="subId" value="100" />

				<input type="hidden" name="kw" value="" />
				<input type="hidden" name="cr" value="" />

				<input type="hidden" name="searchstr" value="" />
				<input type="hidden" name="lpurl" value="http://info.puppetlabs.com/testsubscription.html?cr={creative}&kw={keyword}"; />
				<input type="hidden" name="formid" value="1013" />
				<input type="hidden" name="returnURL" value="https://puppetlabs.com/misc/subscription-thank-you/"; />
				<input type="hidden" name="retURL" value="https://puppetlabs.com/misc/subscription-thank-you/"; />
				<input type="hidden" name="_mkt_disp" value="return" />
				<input type="hidden" name="_mkt_trk" value="" />

				</form>
				<script type="text/javascript" src="https://puppetlabs.com/sites/default/files/mktFormSupport.js"></script>

				<script type="text/javascript">
				function formSubmit(elt) {
				return Mkto.formSubmit(elt);
				}
				function formReset(elt) {
				return Mkto.formReset(elt);
				}
				</script>

<a href="http://info.puppetlabs.com/puppet-enterprise" class="fbtn">Try Puppet Enterprise FREE</a>

            </section>
            <section id="elsewhere">
              <h4>Get Involved</h4>
              <ul>

                <li class="chat"><a href="https://webchat.freenode.net/?channels=puppet" rel="external"><span class="indicator"></span><span>Chat with us on IRC</span></a></li>
		<li class="discussion"><a href="https://groups.google.com/group/puppet-dev" rel="external"><span class="indicator"></span><span>Join the Puppet Developer List</span></a></li>
                <li class="discussion"><a href="https://groups.google.com/group/puppet-users?pli=1" rel="external"><span class="indicator"></span><span>Join the Puppet User List</span></a></li>

                <li class="linkedin"><a href="http://www.linkedin.com/groups?about=&gid=696467&trk=anet_ug_grppro" rel="external"><span class="indicator"></span><span>Join the Puppet Users LinkedIn group</span></a></li>

              </ul>
		<p>
		              		<h4>Follow us&#8230;</h4>

              		<ul class="followus">


			<li><a href="http://feeds.feedburner.com/PuppetLabs" target="_blank"><img src="https://puppetlabs.com/wp-content/plugins/my-profiles/images/rss.png" border="0"></a></li>
			<li><a href="https://www.facebook.com/pages/Puppet-Labs/219089920711" target="_blank"><img src="https://puppetlabs.com/wp-content/plugins/my-profiles/images/facebook.png" border="0"></a></li>
			<li><a href="https://www.twitter.com/puppetlabs" target="_blank"><img src="https://puppetlabs.com/wp-content/plugins/my-profiles/images/twitter.png" border="0"></a></li>
			<li><a href="http://www.linkedin.com/groups?about=&amp;gid=696467&amp;trk=anet_ug_grppro" target="_blank"><img src="https://puppetlabs.com/wp-content/uploads/2011/01/LinkedIn_IN_Icon_32px.png" border="0"></a></li>    <li><a href="https://github.com/puppetlabs" target="_blank"><img src="https://puppetlabs.com/wp-content/uploads/2011/01/github_icon.png" border="0"></a></li>
			<li><a href="https://plus.google.com/112682055028218091774?rel=author" target="_blank"><img src="https://puppetlabs.com/wp-content/uploads/2013/05/google_plus32x32.png" alt="Find Us on Google+" border="0"></a></li>
					</ul>

              	</p>

            </section>
          </div>
          <div class="secondary-content">
            <section id="book-it">
              <h4>Get the book!</h4>

              <p>Written by Spencer Krum, Ben Kero, William Van Hevelingen, James Turnbull and Jeff McCune, <a href="http://www.apress.com/9781430260400" rel="nofollow">Pro Puppet, Second Edition</a> is a comprehensive and up-to-date look at Puppet and MCollective. </p>
              <a href="http://www.apress.com/9781430260400" rel="nofollow"><img src="/images/propuppet2thumb.png" height="161" width="131" alt="Pro Puppet, Second Edition" title="Pro Puppet, Second Edition"/></a>
            </section>
          </div>
        </div>
      </div>
		</footer>

    <div id="copyright">
      <div class="site-width">
        &copy; 2014 <a href="https://puppetlabs.com/" title="Puppet Labs">Puppet Labs</a> &nbsp;&nbsp;•&nbsp;&nbsp; <a href="https://puppetlabs.com/terms">Terms of Use</a>
        <span class="vcard">
         <span class="org"></span>
         <a class="email" href="mailto:info@puppetlabs.com">info@puppetlabs.com</a>

          <span class="adr">
           <span class="street-address">926 NW 13th Avenue #210</span>
           /
           <span class="locality">Portland</span>,
           <span class="region">OR</span>
           <span class="postal-code">97209</span>

          </span>

         <span class="tel">1-877-575-9775</span>
        </span>
      </div>
    </div>

  	<style type="text/css">h1, h2, .btn { visibility : visible; }</style>


<!-- BEGIN: MARKETO TRACKING -->
<!-- Per Alanna, this must be directly before the closing body tag. -->
    <script src="https://munchkin.marketo.net/munchkin.js" type="text/javascript"></script> <script>mktoMunchkin("307-QLA-991");</script>
 <!-- END: MARKETO TRACKING -->
	</body>
</html>
